<%- |
  Stdlib::IP::Address::V4::CIDR $local_addr4,
  Stdlib::IP::Address::V6::CIDR $local_addr6,
  String $private_key,
  Array[Hash] $peers,
| -%>
[Interface]
Address = <%= $local_addr4 %>, <%= $local_addr6 %>
ListenPort = 51820
PrivateKey = <%= $private_key %>
<%- $peers.each |$peer| { -%>

[Peer]
PublicKey = <%= $peer['PublicKey'] %>
AllowedIPS = <%= $peer['AllowedIPS'] %>
<%- if $peer['Endpoint'] { -%>
Endpoint = <%= $peer['Endpoint'] %>
<%- } -%>
<%- } -%>
